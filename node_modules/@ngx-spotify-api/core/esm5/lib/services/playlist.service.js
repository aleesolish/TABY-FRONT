/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable, Optional } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { of } from 'rxjs';
import { map } from 'rxjs/operators';
import { ApiConfig } from '../models';
import * as i0 from "@angular/core";
import * as i1 from "../models/configs/api.config";
import * as i2 from "@angular/common/http";
var Snapshot = /** @class */ (function () {
    function Snapshot() {
    }
    return Snapshot;
}());
if (false) {
    /** @type {?} */
    Snapshot.prototype.snapshotId;
}
var PlaylistService = /** @class */ (function () {
    function PlaylistService(config, http) {
        this.config = config;
        this.http = http;
    }
    /**
     * @param {?} id
     * @param {?} uris
     * @param {?} position
     * @return {?}
     */
    PlaylistService.prototype.addTracksToPlaylist = /**
     * @param {?} id
     * @param {?} uris
     * @param {?} position
     * @return {?}
     */
    function (id, uris, position) {
        if (typeof uris !== typeof [] || uris.length < 1 || uris.length > 100) {
            return of(null);
        }
        return this.http.post(this.config.baseUrl + ("/v1/playlists/" + id + "/tracks"), {
            uris: uris,
            position: position
        }).pipe(map(function (_a) {
            var snapshotId = _a.snapshotId;
            return snapshotId;
        }));
    };
    /**
     * @param {?} id
     * @param {?} uris
     * @return {?}
     */
    PlaylistService.prototype.removeTracksFromPlaylist = /**
     * @param {?} id
     * @param {?} uris
     * @return {?}
     */
    function (id, uris) {
        if (typeof uris !== typeof [] || uris.length < 1 || uris.length > 100) {
            return of(null);
        }
        return this.http.request('DELETE', this.config.baseUrl + ("/v1/playlists/" + id + "/tracks"), {
            body: {
                tracks: uris.map(function (uri) {
                    return { uri: uri };
                })
            }
        }).pipe(map(function (_a) {
            var snapshotId = _a.snapshotId;
            return snapshotId;
        }));
    };
    /**
     * @param {?} id
     * @param {?=} market
     * @return {?}
     */
    PlaylistService.prototype.getPlaylist = /**
     * @param {?} id
     * @param {?=} market
     * @return {?}
     */
    function (id, market) {
        return this.http.get(this.config.baseUrl + ("/v1/playlists/" + id), {
            params: {
                market: market || ''
            }
        });
    };
    /**
     * @param {?} id
     * @param {?} market
     * @param {?=} limit
     * @param {?=} offset
     * @return {?}
     */
    PlaylistService.prototype.getPlaylistTracks = /**
     * @param {?} id
     * @param {?} market
     * @param {?=} limit
     * @param {?=} offset
     * @return {?}
     */
    function (id, market, limit, offset) {
        if (limit === void 0) { limit = 100; }
        if (offset === void 0) { offset = 0; }
        return this.http.get(this.config.baseUrl + ("/v1/playlists/" + id + "/tracks"), {
            params: {
                limit: limit.toString(),
                offset: offset.toString(),
                market: market
            }
        });
    };
    /**
     * @param {?} id
     * @return {?}
     */
    PlaylistService.prototype.getPlaylistCover = /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        return this.http.get(this.config.baseUrl + ("/v1/playlists/" + id + "/images"));
    };
    /**
     *
     * @param id id of playlist
     * @param image base64 encoded jpeg (max. 256KB)
     */
    /**
     *
     * @param {?} id id of playlist
     * @param {?} image base64 encoded jpeg (max. 256KB)
     * @return {?}
     */
    PlaylistService.prototype.uploadPlaylistCover = /**
     *
     * @param {?} id id of playlist
     * @param {?} image base64 encoded jpeg (max. 256KB)
     * @return {?}
     */
    function (id, image) {
        return this.http.put(this.config.baseUrl + ("/v1/playlists/" + id + "/images"), image, {
            headers: {
                'Content-Type': 'image/jpeg'
            }
        }).pipe(map(function (res) {
            return true;
        }));
    };
    /**
     *
     * @param limit min=1, default=20, max=50
     * @param offset min=0, default=0, max=100000
     */
    /**
     *
     * @param {?=} limit min=1, default=20, max=50
     * @param {?=} offset min=0, default=0, max=100000
     * @return {?}
     */
    PlaylistService.prototype.getOwnPlaylists = /**
     *
     * @param {?=} limit min=1, default=20, max=50
     * @param {?=} offset min=0, default=0, max=100000
     * @return {?}
     */
    function (limit, offset) {
        if (limit === void 0) { limit = 20; }
        if (offset === void 0) { offset = 0; }
        return this.http.get(this.config.baseUrl + "/v1/me/playlists", {
            params: {
                limit: limit.toString(),
                offset: offset.toString()
            }
        });
    };
    /**
     * @param {?} id
     * @param {?=} name
     * @param {?=} isPublic
     * @param {?=} isCollaborative
     * @param {?=} description
     * @return {?}
     */
    PlaylistService.prototype.updateDetails = /**
     * @param {?} id
     * @param {?=} name
     * @param {?=} isPublic
     * @param {?=} isCollaborative
     * @param {?=} description
     * @return {?}
     */
    function (id, name, isPublic, isCollaborative, description) {
        return this.http.put(this.config.baseUrl + ("/v1/playlists/" + id), {
            name: name,
            public: isPublic,
            collaborative: isCollaborative,
            description: description
        }, {
            headers: {
                'Content-Type': 'application/json'
            }
        }).pipe(map(function (res) {
            return true;
        }));
    };
    /**
     * @param {?} id
     * @param {?=} limit
     * @param {?=} offset
     * @return {?}
     */
    PlaylistService.prototype.getUsersPlaylists = /**
     * @param {?} id
     * @param {?=} limit
     * @param {?=} offset
     * @return {?}
     */
    function (id, limit, offset) {
        if (limit === void 0) { limit = 20; }
        if (offset === void 0) { offset = 0; }
        return this.http.get(this.config.baseUrl + ("/v1/users/" + id + "/playlists"), {
            params: {
                limit: limit.toString(),
                offset: offset.toString()
            }
        });
    };
    /**
     * @param {?} id
     * @param {?} uris
     * @return {?}
     */
    PlaylistService.prototype.replacePlaylistTracks = /**
     * @param {?} id
     * @param {?} uris
     * @return {?}
     */
    function (id, uris) {
        return this.http.put(this.config.baseUrl + ("/v1/playlists/" + id + "/tracks"), {
            uris: uris
        }, {
            headers: {
                'Content-Type': 'application/json'
            }
        }).pipe(map(function (res) {
            return true;
        }));
    };
    /**
     * @param {?} userid
     * @param {?} name
     * @param {?} isPublic
     * @param {?} isCollaborative
     * @param {?=} description
     * @return {?}
     */
    PlaylistService.prototype.createPlaylists = /**
     * @param {?} userid
     * @param {?} name
     * @param {?} isPublic
     * @param {?} isCollaborative
     * @param {?=} description
     * @return {?}
     */
    function (userid, name, isPublic, isCollaborative, description) {
        if (description === void 0) { description = ''; }
        return this.http.post(this.config.baseUrl + ("/v1/users/" + userid + "/playlists"), {
            name: name,
            public: isPublic,
            collaborative: isCollaborative,
            description: description
        }, {
            headers: {
                'Content-Type': 'application/json'
            }
        });
    };
    /**
     * @param {?} id
     * @param {?} rangeStart
     * @param {?} rangeLength
     * @param {?} insertBefore
     * @param {?=} snapshot
     * @return {?}
     */
    PlaylistService.prototype.reorderPlaylistTracks = /**
     * @param {?} id
     * @param {?} rangeStart
     * @param {?} rangeLength
     * @param {?} insertBefore
     * @param {?=} snapshot
     * @return {?}
     */
    function (id, rangeStart, rangeLength, insertBefore, snapshot) {
        return this.http.put(this.config.baseUrl + ("/v1/playlists/" + id + "/tracks"), {
            range_start: rangeStart,
            insert_before: insertBefore,
            range_length: rangeLength,
            snapshot_id: snapshot
        }, {
            headers: {
                'Content-Type': 'application/json'
            }
        }).pipe(map(function (s) { return s.snapshotId; }));
    };
    PlaylistService.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] }
    ];
    /** @nocollapse */
    PlaylistService.ctorParameters = function () { return [
        { type: ApiConfig, decorators: [{ type: Optional }] },
        { type: HttpClient }
    ]; };
    /** @nocollapse */ PlaylistService.ngInjectableDef = i0.defineInjectable({ factory: function PlaylistService_Factory() { return new PlaylistService(i0.inject(i1.ApiConfig, 8), i0.inject(i2.HttpClient)); }, token: PlaylistService, providedIn: "root" });
    return PlaylistService;
}());
export { PlaylistService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    PlaylistService.prototype.config;
    /**
     * @type {?}
     * @private
     */
    PlaylistService.prototype.http;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGxheWxpc3Quc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BuZ3gtc3BvdGlmeS1hcGkvY29yZS8iLCJzb3VyY2VzIjpbImxpYi9zZXJ2aWNlcy9wbGF5bGlzdC5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUMsVUFBVSxFQUFFLFFBQVEsRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUNuRCxPQUFPLEVBQUMsVUFBVSxFQUFlLE1BQU0sc0JBQXNCLENBQUM7QUFDOUQsT0FBTyxFQUFhLEVBQUUsRUFBQyxNQUFNLE1BQU0sQ0FBQztBQUNwQyxPQUFPLEVBQUMsR0FBRyxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFLbkMsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLFdBQVcsQ0FBQzs7OztBQUVwQztJQUFBO0lBRUEsQ0FBQztJQUFELGVBQUM7QUFBRCxDQUFDLEFBRkQsSUFFQzs7O0lBREMsOEJBQW1COztBQUdyQjtJQUtFLHlCQUFnQyxNQUFpQixFQUM3QixJQUFnQjtRQURKLFdBQU0sR0FBTixNQUFNLENBQVc7UUFDN0IsU0FBSSxHQUFKLElBQUksQ0FBWTtJQUFJLENBQUM7Ozs7Ozs7SUFFbEMsNkNBQW1COzs7Ozs7SUFBMUIsVUFBMkIsRUFBVSxFQUFFLElBQWMsRUFBRSxRQUFnQjtRQUNyRSxJQUFJLE9BQU8sSUFBSSxLQUFLLE9BQU8sRUFBRSxJQUFJLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxJQUFJLElBQUksQ0FBQyxNQUFNLEdBQUcsR0FBRyxFQUFFO1lBQ3JFLE9BQU8sRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ2pCO1FBQ0QsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBVyxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sSUFBRyxtQkFBaUIsRUFBRSxZQUFTLENBQUEsRUFBRTtZQUNsRixJQUFJLEVBQUUsSUFBSTtZQUNWLFFBQVEsRUFBRSxRQUFRO1NBQ25CLENBQUMsQ0FB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WUFDakYsV0FBVyxFQUFFLFVBQVU7WUFDdkIsYUFBYSxFQUFFLFlBQVk7WUFDM0IsWUFBWSxFQUFFLFdBQVc7WUFDekIsV0FBVyxFQUFFLFFBQVE7U0FDdEIsRUFBRTtZQUNELE9BQU8sRUFBRTtnQkFDUCxjQUFjLEVBQUUsa0JBQWtCO2FBQ25DO1NBQ0YsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsVUFBQyxDQUFXLElBQUssT0FBQSxDQUFDLENBQUMsVUFBVSxFQUFaLENBQVksQ0FBQyxDQUFDLENBQUM7SUFDOUMsQ0FBQzs7Z0JBbEpGLFVBQVUsU0FBQztvQkFDVixVQUFVLEVBQUUsTUFBTTtpQkFDbkI7Ozs7Z0JBUk8sU0FBUyx1QkFXRixRQUFRO2dCQWxCZixVQUFVOzs7MEJBRGxCO0NBaUtDLEFBbkpELElBbUpDO1NBaEpZLGVBQWU7Ozs7OztJQUVkLGlDQUFxQzs7Ozs7SUFDckMsK0JBQXdCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtJbmplY3RhYmxlLCBPcHRpb25hbH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7SHR0cENsaWVudCwgSHR0cFJlc3BvbnNlfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XHJcbmltcG9ydCB7T2JzZXJ2YWJsZSwgb2Z9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQge21hcH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQge1BsYXlsaXN0fSBmcm9tICcuLi9tb2RlbHMnO1xyXG5pbXBvcnQge1BhZ2luZ30gZnJvbSAnLi4vbW9kZWxzJztcclxuaW1wb3J0IHtQbGF5bGlzdFRyYWNrfSBmcm9tICcuLi9tb2RlbHMnO1xyXG5pbXBvcnQge0ltYWdlfSBmcm9tICcuLi9tb2RlbHMnO1xyXG5pbXBvcnQge0FwaUNvbmZpZ30gZnJvbSAnLi4vbW9kZWxzJztcclxuXHJcbmNsYXNzIFNuYXBzaG90IHtcclxuICBzbmFwc2hvdElkOiBzdHJpbmc7XHJcbn1cclxuXHJcbkBJbmplY3RhYmxlKHtcclxuICBwcm92aWRlZEluOiAncm9vdCdcclxufSlcclxuZXhwb3J0IGNsYXNzIFBsYXlsaXN0U2VydmljZSB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKEBPcHRpb25hbCgpIHByaXZhdGUgY29uZmlnOiBBcGlDb25maWcsXHJcbiAgICAgICAgICAgICAgcHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50KSB7IH1cclxuXHJcbiAgcHVibGljIGFkZFRyYWNrc1RvUGxheWxpc3QoaWQ6IHN0cmluZywgdXJpczogc3RyaW5nW10sIHBvc2l0aW9uOiBudW1iZXIpOiBPYnNlcnZhYmxlPHN0cmluZz4ge1xyXG4gICAgaWYgKHR5cGVvZiB1cmlzICE9PSB0eXBlb2YgW10gfHwgdXJpcy5sZW5ndGggPCAxIHx8IHVyaXMubGVuZ3RoID4gMTAwKSB7XHJcbiAgICAgIHJldHVybiBvZihudWxsKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLmh0dHAucG9zdDxTbmFwc2hvdD4odGhpcy5jb25maWcuYmFzZVVybCArIGAvdjEvcGxheWxpc3RzLyR7aWR9L3RyYWNrc2AsIHtcclxuICAgICAgdXJpczogdXJpcyxcclxuICAgICAgcG9zaXRpb246IHBvc2l0aW9uXHJcbiAgICB9KS5waXBlKG1hcCgoeyBzbmFwc2hvdElkIH0pID0+IHtcclxuICAgICAgcmV0dXJuIHNuYXBzaG90SWQ7XHJcbiAgICB9KSk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgcmVtb3ZlVHJhY2tzRnJvbVBsYXlsaXN0KGlkOiBzdHJpbmcsIHVyaXM6IHN0cmluZ1tdKTogT2JzZXJ2YWJsZTxzdHJpbmc+IHtcclxuICAgIGlmICh0eXBlb2YgdXJpcyAhPT0gdHlwZW9mIFtdIHx8IHVyaXMubGVuZ3RoIDwgMSB8fCB1cmlzLmxlbmd0aCA+IDEwMCkge1xyXG4gICAgICByZXR1cm4gb2YobnVsbCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5odHRwLnJlcXVlc3Q8U25hcHNob3Q+KCdERUxFVEUnLCB0aGlzLmNvbmZpZy5iYXNlVXJsICsgYC92MS9wbGF5bGlzdHMvJHtpZH0vdHJhY2tzYCwge1xyXG4gICAgICBib2R5OiB7XHJcbiAgICAgICAgdHJhY2tzOiB1cmlzLm1hcCgodXJpOiBzdHJpbmcpID0+IHtcclxuICAgICAgICAgIHJldHVybiB7IHVyaTogdXJpIH07XHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgfSkucGlwZShtYXAoKHsgc25hcHNob3RJZCB9KSA9PiB7XHJcbiAgICAgIHJldHVybiBzbmFwc2hvdElkO1xyXG4gICAgfSkpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldFBsYXlsaXN0KGlkOiBzdHJpbmcsIG1hcmtldD86IHN0cmluZyk6IE9ic2VydmFibGU8UGxheWxpc3Q+IHtcclxuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0PFBsYXlsaXN0Pih0aGlzLmNvbmZpZy5iYXNlVXJsICsgYC92MS9wbGF5bGlzdHMvJHtpZH1gLCB7XHJcbiAgICAgIHBhcmFtczoge1xyXG4gICAgICAgIG1hcmtldDogbWFya2V0IHx8ICcnXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldFBsYXlsaXN0VHJhY2tzKGlkOiBzdHJpbmcsIG1hcmtldDogc3RyaW5nLCBsaW1pdDogbnVtYmVyID0gMTAwLCBvZmZzZXQ6IG51bWJlciA9IDApOiBPYnNlcnZhYmxlPFBhZ2luZzxQbGF5bGlzdFRyYWNrPj4ge1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQ8UGFnaW5nPFBsYXlsaXN0VHJhY2s+Pih0aGlzLmNvbmZpZy5iYXNlVXJsICsgYC92MS9wbGF5bGlzdHMvJHtpZH0vdHJhY2tzYCwge1xyXG4gICAgICBwYXJhbXM6IHtcclxuICAgICAgICBsaW1pdDogbGltaXQudG9TdHJpbmcoKSxcclxuICAgICAgICBvZmZzZXQ6IG9mZnNldC50b1N0cmluZygpLFxyXG4gICAgICAgIG1hcmtldDogbWFya2V0XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldFBsYXlsaXN0Q292ZXIoaWQ6IHN0cmluZyk6IE9ic2VydmFibGU8SW1hZ2VbXT4ge1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQ8SW1hZ2VbXT4odGhpcy5jb25maWcuYmFzZVVybCArIGAvdjEvcGxheWxpc3RzLyR7aWR9L2ltYWdlc2ApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICpcclxuICAgKiBAcGFyYW0gaWQgaWQgb2YgcGxheWxpc3RcclxuICAgKiBAcGFyYW0gaW1hZ2UgYmFzZTY0IGVuY29kZWQganBlZyAobWF4LiAyNTZLQilcclxuICAgKi9cclxuICBwdWJsaWMgdXBsb2FkUGxheWxpc3RDb3ZlcihpZDogc3RyaW5nLCBpbWFnZTogc3RyaW5nKTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwLnB1dCh0aGlzLmNvbmZpZy5iYXNlVXJsICsgYC92MS9wbGF5bGlzdHMvJHtpZH0vaW1hZ2VzYCwgaW1hZ2UsIHtcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnaW1hZ2UvanBlZydcclxuICAgICAgfVxyXG4gICAgfSkucGlwZShtYXAoKHJlczogSHR0cFJlc3BvbnNlPGFueT4pID0+IHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9KSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKlxyXG4gICAqIEBwYXJhbSBsaW1pdCBtaW49MSwgZGVmYXVsdD0yMCwgbWF4PTUwXHJcbiAgICogQHBhcmFtIG9mZnNldCBtaW49MCwgZGVmYXVsdD0wLCBtYXg9MTAwMDAwXHJcbiAgICovXHJcbiAgcHVibGljIGdldE93blBsYXlsaXN0cyhsaW1pdDogbnVtYmVyID0gMjAsIG9mZnNldDogbnVtYmVyID0gMCk6IE9ic2VydmFibGU8UGFnaW5nPFBsYXlsaXN0Pj4ge1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQ8UGFnaW5nPFBsYXlsaXN0Pj4odGhpcy5jb25maWcuYmFzZVVybCArIGAvdjEvbWUvcGxheWxpc3RzYCwge1xyXG4gICAgICBwYXJhbXM6IHtcclxuICAgICAgICBsaW1pdDogbGltaXQudG9TdHJpbmcoKSxcclxuICAgICAgICBvZmZzZXQ6IG9mZnNldC50b1N0cmluZygpXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHVwZGF0ZURldGFpbHMoaWQ6IHN0cmluZywgbmFtZT86IHN0cmluZywgaXNQdWJsaWM/OiBib29sZWFuLCBpc0NvbGxhYm9yYXRpdmU/OiBib29sZWFuLCBkZXNjcmlwdGlvbj86IHN0cmluZyk6IE9ic2VydmFibGU8Ym9vbGVhbj4ge1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5wdXQodGhpcy5jb25maWcuYmFzZVVybCArIGAvdjEvcGxheWxpc3RzLyR7aWR9YCwge1xyXG4gICAgICBuYW1lLFxyXG4gICAgICBwdWJsaWM6IGlzUHVibGljLFxyXG4gICAgICBjb2xsYWJvcmF0aXZlOiBpc0NvbGxhYm9yYXRpdmUsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvblxyXG4gICAgfSwge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICB9XHJcbiAgICB9KS5waXBlKG1hcCgocmVzOiBIdHRwUmVzcG9uc2U8YW55Pik6IGJvb2xlYW4gPT4ge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0pKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXRVc2Vyc1BsYXlsaXN0cyhpZDogc3RyaW5nLCBsaW1pdDogbnVtYmVyID0gMjAsIG9mZnNldDogbnVtYmVyID0gMCk6IE9ic2VydmFibGU8UGFnaW5nPFBsYXlsaXN0Pj4ge1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQ8UGFnaW5nPFBsYXlsaXN0Pj4odGhpcy5jb25maWcuYmFzZVVybCArIGAvdjEvdXNlcnMvJHtpZH0vcGxheWxpc3RzYCwge1xyXG4gICAgICBwYXJhbXM6IHtcclxuICAgICAgICBsaW1pdDogbGltaXQudG9TdHJpbmcoKSxcclxuICAgICAgICBvZmZzZXQ6IG9mZnNldC50b1N0cmluZygpXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHJlcGxhY2VQbGF5bGlzdFRyYWNrcyhpZDogc3RyaW5nLCB1cmlzOiBzdHJpbmdbXSk6IE9ic2VydmFibGU8Ym9vbGVhbj4ge1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5wdXQodGhpcy5jb25maWcuYmFzZVVybCArIGAvdjEvcGxheWxpc3RzLyR7aWR9L3RyYWNrc2AsIHtcclxuICAgICAgdXJpczogdXJpc1xyXG4gICAgfSwge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICB9XHJcbiAgICB9KS5waXBlKG1hcCgocmVzOiBIdHRwUmVzcG9uc2U8YW55Pik6IGJvb2xlYW4gPT4ge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0pKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBjcmVhdGVQbGF5bGlzdHModXNlcmlkOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgaXNQdWJsaWM6IGJvb2xlYW4sIGlzQ29sbGFib3JhdGl2ZTogYm9vbGVhbiwgZGVzY3JpcHRpb246IHN0cmluZyA9ICcnKTogT2JzZXJ2YWJsZTxQbGF5bGlzdD4ge1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5wb3N0PFBsYXlsaXN0Pih0aGlzLmNvbmZpZy5iYXNlVXJsICsgYC92MS91c2Vycy8ke3VzZXJpZH0vcGxheWxpc3RzYCwge1xyXG4gICAgICBuYW1lLFxyXG4gICAgICBwdWJsaWM6IGlzUHVibGljLFxyXG4gICAgICBjb2xsYWJvcmF0aXZlOiBpc0NvbGxhYm9yYXRpdmUsXHJcbiAgICAgIGRlc2NyaXB0aW9uXHJcbiAgICB9LCB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHJlb3JkZXJQbGF5bGlzdFRyYWNrcyhpZDogc3RyaW5nLCByYW5nZVN0YXJ0OiBudW1iZXIsIHJhbmdlTGVuZ3RoOiBudW1iZXIsIGluc2VydEJlZm9yZTogbnVtYmVyLCBzbmFwc2hvdD86IHN0cmluZyk6IE9ic2VydmFibGU8c3RyaW5nPiB7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwLnB1dDxTbmFwc2hvdD4odGhpcy5jb25maWcuYmFzZVVybCArIGAvdjEvcGxheWxpc3RzLyR7aWR9L3RyYWNrc2AsIHtcclxuICAgICAgcmFuZ2Vfc3RhcnQ6IHJhbmdlU3RhcnQsXHJcbiAgICAgIGluc2VydF9iZWZvcmU6IGluc2VydEJlZm9yZSxcclxuICAgICAgcmFuZ2VfbGVuZ3RoOiByYW5nZUxlbmd0aCxcclxuICAgICAgc25hcHNob3RfaWQ6IHNuYXBzaG90XHJcbiAgICB9LCB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcbiAgICAgIH1cclxuICAgIH0pLnBpcGUobWFwKChzOiBTbmFwc2hvdCkgPT4gcy5zbmFwc2hvdElkKSk7XHJcbiAgfVxyXG59XHJcbiJdfQ==